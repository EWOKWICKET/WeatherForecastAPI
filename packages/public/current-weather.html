<!DOCTYPE html>
<html lang="en">
  <body>
    <h1>Current Weather</h1>
    <form id="weather-form">
      <label for="city">City:</label>
      <input type="text" id="city" placeholder="Enter city name" required />
      <br /><br />

      <button type="submit">Submit</button>
    </form>

    <div id="result"></div>

    <a href="/weatherapi.app/subscribe"> Subscribe </a>

    <script>
      document.getElementById('weather-form').addEventListener('submit', async function (e) {
        e.preventDefault();
        const city = document.getElementById('city').value.trim();
        if (!city) return;

        const url = 'http://localhost:3000/weatherapi.app/api/weather?city=' + encodeURIComponent(city);
        const result = document.getElementById('result');
        result.textContent = 'Loadingâ€¦';

        try {
          const res = await fetch(url);
          const data = await res.json();
          if (res.status !== 200) throw new Error(data.message);

          result.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          result.textContent = err.message;
        }
      });
    </script>
  </body>
</html>
